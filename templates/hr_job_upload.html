<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JobStir - Upload a Job</title>
    <!-- Tailwind CSS CDN - Used for foundational reset and default browser styles -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Favicon link to prevent 404 for favicon.ico -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22 color=%22white%22>JB</text></svg>" />
    <link rel="stylesheet" href="{{ url_for('static', filename='css/hr_job_upload.css') }}">
      <script async src="https://www.googletagmanager.com/gtag/js?id=G-X4H5RPBG76"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-X4H5RPBG76');
</script>
</head>
<body>
 <div class="page-wrapper">
        <section class="hero-section fade-in">
            <h1 class="hero-title">Upload a Job Opportunity</h1>
            <p class="hero-subtitle">Easily post your openings to attract top-matched talent using JobStir's AI-powered engine.</p>
        </section>

        <main class="main-content-grid">
            <section class="info-column fade-in">
                <h2>Why Post with JobStir?</h2>
                <p>JobStir leverages advanced AI to intelligently match your job openings with the most qualified candidates, cutting down on screening time and improving hiring quality.</p>
                <a href="{{ url_for('hr_dashboard') }}" class="btn-secondary-cta">View Your Dashboard</a>
            </section>

            <section class="form-section fade-in">
                <form id="jobUploadForm">
                    <div id="errorMessage" class="error-message hidden"></div>
                    
                    <div class="form-group">
                        <label for="company_name" class="form-label">Company Name</label>
                        <input type="text" id="company_name" name="company_name" required class="input-field" placeholder="e.g., Tech Innovators Inc.">
                    </div>
                    <div class="form-group">
                        <label for="job_title" class="form-label">Job Title</label>
                        <input type="text" id="job_title" name="job_title" required class="input-field" placeholder="e.g., Senior Software Engineer">
                    </div>
                    <div class="form-group">
                        <div class="label-with-counter">
                            <label for="job_description" class="form-label">Job Description</label>
                            
                        </div>
                        <textarea id="job_description" name="job_description" rows="8" required class="input-field" placeholder="Provide a detailed description..." maxlength="5000"></textarea>
                    </div>
                    <div class="submit-button-wrapper">
                        <button type="submit" id="submitBtn" class="btn-primary">
                            <span class="btn-text">Upload Job</span>
                            <span class="btn-spinner hidden"></span>
                        </button>
                    </div>
                </form>

                <div id="successMessage" class="success-message hidden">
                    <svg class="success-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                    <span>Your job has been posted successfully!</span>
                    <button id="postAnotherJobBtn" class="btn-secondary-cta">Post Another Job</button>
                </div>
            </section>
        </main>
        
        <section class="post-job-process-section fade-in">
             </section>
    </div>


        <!-- What Happens After You Post a Job Section -->
        <section class="post-job-process-section fade-in">
            <h2>What Happens After You Post a Job?</h2>
            <div class="process-steps-grid">
                <div class="process-step-card">
                    <span class="step-number">1.</span>
                    <svg class="step-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"></path>
                    </svg>
                    <h3>Job is Reviewed</h3>
                    <p>Your job opening is quickly reviewed for clarity and completeness to ensure optimal matching.</p>
                </div>
                <div class="process-step-card">
                    <span class="step-number">2.</span>
                    <svg class="step-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z"></path>
                    </svg>
                    <h3>AI Matches Candidates</h3>
                    <p>Our intelligent AI scans our talent pool to find candidates whose skills and experience align perfectly.</p>
                </div>
                <div class="process-step-card">
                    <span class="step-number">3.</span>
                    <svg class="step-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M15 17v2m-6-2v2m0-5h6m-6-5h6M9 3V2a1 1 0 011-1h4a1 1 0 011 1v1M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path>
                    </svg>
                    <h3>You Get Shortlists</h3>
                    <p>Receive a curated shortlist of top-matched candidates, complete with detailed profiles and match scores.</p>
                </div>
                <div class="process-step-card">
                    <span class="step-number">4.</span>
                    <svg class="step-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                    </svg>
                    <h3>Schedule Interviews</h3>
                    <p>Easily schedule interviews and manage communications with promising candidates directly through the platform.</p>
                </div>
            </div>
        </section>
    </div>

    <script>
        document.getElementById('jobUploadForm').addEventListener('submit', async function(event) {
            event.preventDefault(); // Prevent default form submission

            const form = event.target;
            const formData = new FormData(form);
            const submitButton = form.querySelector('button[type="submit"]');
            const successMessage = document.getElementById('successMessage');

            submitButton.disabled = true; // Disable button during submission
            submitButton.textContent = 'Uploading...'; // Change button text

            try {
                const response = await fetch('/hr_job_upload', {
                    method: 'POST',
                    body: formData
                });

                if (response.ok) {
                    // Handle success
                    form.reset(); // Clear the form
                    form.style.display = 'none'; // Hide the form
                    successMessage.classList.remove('hidden'); // Show success message
                    successMessage.classList.add('show'); // Trigger fade-in animation
                    console.log('Job posted successfully!');
                    // Optionally, redirect after a short delay
                    // setTimeout(() => {
                    //     window.location.href = '/hr_dashboard';
                    // }, 2000);
                } else {
                    // Handle errors
                    const errorData = await response.json();
                    // Using a custom modal/message box would be better than alert() for consistency
                    alert('Error: ' + (errorData.error || 'Failed to upload job.'));
                    console.error('Failed to upload job:', errorData);
                }
            } catch (error) {
                console.error('Network error:', error);
                // Using a custom modal/message box would be better than alert() for consistency
                alert('An unexpected error occurred. Please try again.');
            } finally {
                submitButton.disabled = false; // Re-enable button
                submitButton.textContent = 'Upload Job'; // Reset button text
            }
        });
    </script>
</body>
</html>
